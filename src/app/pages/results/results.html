<section>
	<app-header class="green-bg"></app-header>

		<button
			(click)="loadMockData()"
			style="
				position: fixed;
				top: 80px;
				right: 20px;
				z-index: 1000;
				padding: 10px;
				background: #000;
				color: #fff;
				border: none;
				border-radius: 5px;
				cursor: pointer;
			"
		>
			Load Mock Data
		</button>

		@if (isLoading()) {
		<div class="loading-container">
			<div class="loading-gif-container">
				<img
					src="img/gif/generating.gif"
					alt="Generating recipes"
					class="loading-gif"
				/>
			</div>
			<h1>Generating your recipes...</h1>
			<p>Depending on your ingredients this may take longer...</p>
		</div>
		} @else if (error()) {
		<div class="error-container">
			<h1>Oops! Something went wrong</h1>
			<p>{{ error() }}</p>
			<button (click)="goBack()">Go Back</button>
		</div>
		} @else if (recipes().length > 0) {
		<div class="container">
			<div class="results">
				<div class="results__head">
					<div class="results__welcome">
						<h1>The recipe results</h1>
						<p class="h5">
							We took what you have and let our AI do the
							thinking.<br />
							Hera are {{ recipes().length }} easy recipes you can
							make right now!
						</p>
						<div class="results__specs">
							<span class="spec pill-creme">{{
								recipeAiService.capitalize(cuisine())
							}}</span>
							<span class="spec pill-creme">{{
								recipeAiService.capitalize(timePreference())
							}}</span>
							@if (diet() && diet() != 'no preferences') {
								<span class="spec pill-creme">{{
									recipeAiService.capitalize(diet())
								}}</span>
							}
						</div>
					</div>
					<img src="img/results/ai_dish.jpg">
				</div>
				<div class="recipes">
					@for (recipe of recipes(); track recipe.recipeName) {
						<div class="recipes__card">
							<div class="recipes__card--head h5">
								<img src="img/icons/dish.svg">
								Recipe {{ $index + 1 }}
							</div>
							<div class="recipes__card--body">
								<h2 class="h4">{{ recipe.recipeName }}</h2>
								<span class="recipes__card--time">
									<img src="img/icons/time.svg">
									Cooking time: {{ recipe.cookTime }}
								</span>
								<button class="main-btn btn-creme--small" (click)="showModal(recipe)">View</button>
							</div>
						</div>
					}
					@if (isModalVisible() && selectedRecipe()) {
						<app-recipe-modal (close)="hideModal()" [recipe]="selectedRecipe()!"></app-recipe-modal>
					}
				</div>
			</div>
		</div>

		<!-- <div class="recipes-container">
			<h1>Your Recipes</h1>
			
			@for (recipe of recipes(); track recipe.recipeName) {
				<div class="recipe-card">
					<div class="recipe-header">
						<h2>{{ recipe.recipeName }}</h2>
						<span class="difficulty">{{ recipe.difficulty }}</span>
					</div>
					
					<p class="description">{{ recipe.description }}</p>
					
					<div class="recipe-meta">
						<div class="meta-item">
							<strong>Prep:</strong> {{ recipe.prepTime }}
						</div>
						<div class="meta-item">
							<strong>Cook:</strong> {{ recipe.cookTime }}
						</div>
						<div class="meta-item">
							<strong>Total:</strong> {{ recipe.totalTime }}
						</div>
						<div class="meta-item">
							<strong>Servings:</strong> {{ recipe.servings }}
						</div>
					</div>
					
					<div class="ingredients-section">
						<h3>Required Ingredients</h3>
						<ul>
							@for (ingredient of recipe.requiredIngredients; track ingredient.name) {
								<li>
									<strong>{{ ingredient.amount }}</strong> {{ ingredient.name }}
									@if (ingredient.preparation) {
										<em>({{ ingredient.preparation }})</em>
									}
								</li>
							}
						</ul>
						
						@if (recipe.optionalIngredients && recipe.optionalIngredients.length > 0) {
							<h3>Optional Ingredients</h3>
							<ul class="optional">
								@for (ingredient of recipe.optionalIngredients; track ingredient.name) {
									<li>
										<strong>{{ ingredient.amount }}</strong> {{ ingredient.name }}
										<em>- {{ ingredient.purpose }}</em>
									</li>
								}
							</ul>
						}
					</div>
					
					<div class="instructions-section">
						<h3>Instructions</h3>
						<ol>
							@for (instruction of recipe.instructions; track instruction.step) {
								<li>
									<div class="instruction-header">
										<span class="assigned-to">{{ instruction.assignedTo }}</span>
										<span class="duration">{{ instruction.duration }}</span>
									</div>
									<p>{{ instruction.action }}</p>
									@if (instruction.tip) {
										<p class="tip">ðŸ’¡ Tip: {{ instruction.tip }}</p>
									}
								</li>
							}
						</ol>
					</div>
					
					<div class="nutrition-section">
						<h3>Nutritional Information (per serving)</h3>
						<div class="nutrition-grid">
							<div class="nutrition-item">
								<strong>Energy:</strong> {{ recipe.nutritionalInfo.perServing.energy }}
							</div>
							<div class="nutrition-item">
								<strong>Fat:</strong> {{ recipe.nutritionalInfo.perServing.fat }}
							</div>
							<div class="nutrition-item">
								<strong>Carbs:</strong> {{ recipe.nutritionalInfo.perServing.carbohydrates }}
							</div>
							<div class="nutrition-item">
								<strong>Protein:</strong> {{ recipe.nutritionalInfo.perServing.protein }}
							</div>
							<div class="nutrition-item">
								<strong>Fiber:</strong> {{ recipe.nutritionalInfo.perServing.fiber }}
							</div>
							<div class="nutrition-item">
								<strong>Sodium:</strong> {{ recipe.nutritionalInfo.perServing.sodium }}
							</div>
						</div>
					</div>
					
					@if (recipe.tips && recipe.tips.length > 0) {
						<div class="tips-section">
							<h3>Tips</h3>
							<ul>
								@for (tip of recipe.tips; track tip) {
									<li>{{ tip }}</li>
								}
							</ul>
						</div>
					}
					
					@if (recipe.storage) {
						<div class="storage-section">
							<h3>Storage</h3>
							<p>{{ recipe.storage }}</p>
						</div>
					}
				</div>
			}
		</div> -->
		}
</section>
